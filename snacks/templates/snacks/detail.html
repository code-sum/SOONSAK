{% extends 'base.html' %}
{% load static %}
{% block content %}
{% load django_bootstrap5 %}

<!-- 권한제한 메시지 -->
{% if messages %}
<div class="alert alert-danger my-3" role="alert">
  {% for message in messages %}
  <strong>{{ message.tags }}</strong>
  <ul>
    <li>{{ message.message }}</li>
  </ul>
  {% endfor %}
</div>
{% endif %}
{% if request.user.is_staff %}
<!-- 제품수정 -->
<a href="{% url 'snacks:update' snack.pk %}">{% bootstrap_button button_type="submit" content="제품수정" %}</a>
<!-- 제품삭제 -->
<a href="{% url 'snacks:delete' snack.pk %}">{% bootstrap_button button_type="submit" content="제품삭제" %}</a>
{% endif %}

<div class="row gx-3">
  <!--카테고리/제품명/제품이미지-->
  <h6 class="mx-2">카테고리> {{ snack.category }}</h6>
  <div class="col-lg-7">
    <h2 class="mx-4 mb-5">{{ snack.name }}</h2>
    <div class="product-title mx-5">
      <div class="product-img-div">
        <a href="#">
          <img class="product-img" src="{{ snack.snack_image.url }}" alt="{{ snack.name }}_이미지">
        </a>
      </div>
    </div>
  </div>
  <!--별점평균/제품 콘텐츠-->
  <div class="col-lg-5 mb-5 mt-5">
    <h4>평균별점</h4>
    <table class="table">
      <tbody>
        <tr>
          <th class="col-3">제품 설명</th>
          <td class="col-9">{{ snack.content }}</td>
        </tr>
        <tr>
          <th class="col-3">가격</th>
          <td class="col-9">{{ snack.price }}</td>
        </tr>
        <tr>
          <th class="col-3">배송비</th>
          <td class="col-9">3000원</td>
        </tr>
        <tr>
          <th class="col-3">재고</th>
          <td class="col-9">{{ snack.stock }}개</td>
        </tr>
      </tbody>
    </table>
    <div class="Cart_form">
      <form method="POST" action="{% url 'carts:add_cart' snack.pk %}">
        {% csrf_token %}
        {% bootstrap_form form %}
        <div >
          <button type="submit" class="btn">바로 주문</button>
          <button type="submit" class="btn">장바구니에 담기</button>
        </div>
      </form>
    </div>
  </div>
  <!-- 리뷰  -->

  <!-- 리뷰 작성 버튼 -->
  <div class="d-flex justify-content-end">
    <a href="{% url 'reviews:create' snack.pk %}"><button type="button" class="btn review_btn">리뷰작성</button></a>
  </div>
  <!--리뷰 카드-->
  <div class="row">
    <!--for문 스낵의 모든 리뷰-->
    <div class="col-12">
      {% for review in reviews %}
      <a href="{% url 'reviews:detail' review.pk %}">
        <div class="card">
          {% if review.review_image %}
          <img src="{{ review.review_image.url }}" class="product-img" alt="상품후기 사진">
          {% endif %}
          <div>
            <p>{{ review.content}}</p>
          </div>
        </div>
      </a>
      {% empty %}
      <h3>아직 작성된 리뷰가 없습니다.</h3>
      {% endfor %}
    </div>
    <!--for문 종료-->
  </div>
</div>

{% endblock content %}